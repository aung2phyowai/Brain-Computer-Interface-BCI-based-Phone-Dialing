<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" >
<head>
<title>Contributions:BCI2000Automation - BCI2000 Help</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Contributions:BCI2000Automation,Contributions:Applications,Contributions:BCI2000Command,Contributions:BCI2000PresentationLink,Contributions:BCI2000PythonBindings,Programming Reference:BCI2000Remote Class,User Reference:Operator Module Scripting" />
<link rel="shortcut icon" href="../../favicon.ico" />
<link rel='stylesheet' type='text/css' media='print' href='../skins/common/wikiprintable.css' />
<link rel="stylesheet" href="../skins/common/wikistandard.css@1" type="text/css" />
<link rel="stylesheet" href="../skins/common/common.css" type="text/css" />
<link rel="stylesheet" href="../skins/common/htmlhelp.css" type="text/css" />

<style type='text/css'>
a.new, #quickbar a.new { color: #CC2200; }
.editsection { display: none; }
#quickbar { position: absolute; top: 4px; left: 4px;  }
#article { margin-left: 152px; margin-right: 4px; }
</style>
</head>

<body bgcolor='#FFFFFF'>

<div id='content'>
<div id='topbar'>
<table border='0' cellspacing='0' width='98%'>
<tr>
</tr>
</table>
</div>

<div id='article'>
<h1 class="pagetitle">BCI2000Automation</h1><p class="subtitle">Contributions</p><hr class="sep" /><table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class='toclevel-1'><a href="Contributions%253ABCI2000Automation.html#Synopsis"><span class="tocnumber">1</span> <span class="toctext">Synopsis</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ABCI2000Automation.html#Location"><span class="tocnumber">2</span> <span class="toctext">Location</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ABCI2000Automation.html#Versioning"><span class="tocnumber">3</span> <span class="toctext">Versioning</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253ABCI2000Automation.html#Author"><span class="tocnumber">3.1</span> <span class="toctext">Author</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ABCI2000Automation.html#Source_Code_Revisions"><span class="tocnumber">3.2</span> <span class="toctext">Source Code Revisions</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253ABCI2000Automation.html#Functional_Description"><span class="tocnumber">4</span> <span class="toctext">Functional Description</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253ABCI2000Automation.html#BCI2000Remote_Members"><span class="tocnumber">4.1</span> <span class="toctext">BCI2000Remote Members</span></a>
<ul>
<li class='toclevel-3'><a href="Contributions%253ABCI2000Automation.html#Properties"><span class="tocnumber">4.1.1</span> <span class="toctext">Properties</span></a>
<ul>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#double_Timeout.3D5_.28rw.29"><span class="tocnumber">4.1.1.1</span> <span class="toctext">double Timeout=5 (rw)</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#string_OperatorPath.3D.3CBCI2000Automation_directory.3E.2FOperator.exe_.28rw.29"><span class="tocnumber">4.1.1.2</span> <span class="toctext">string OperatorPath=&lt;BCI2000Automation directory&gt;/Operator.exe (rw)</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#string_TelnetAddress.3Dlocalhost:3999_.28rw.29"><span class="tocnumber">4.1.1.3</span> <span class="toctext">string TelnetAddress=localhost:3999 (rw)</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_WindowVisible.3Dtrue_.28rw.29"><span class="tocnumber">4.1.1.4</span> <span class="toctext">bool WindowVisible=true (rw)</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#string_WindowTitle_.28rw.29"><span class="tocnumber">4.1.1.5</span> <span class="toctext">string WindowTitle (rw)</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#string_Result_.28r.29"><span class="tocnumber">4.1.1.6</span> <span class="toctext">string Result (r)</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#Recording_information"><span class="tocnumber">4.1.1.7</span> <span class="toctext">Recording information</span></a>
<ul>
<li class='toclevel-5'><a href="Contributions%253ABCI2000Automation.html#string_SubjectID_.28rw.29"><span class="tocnumber">4.1.1.7.1</span> <span class="toctext">string SubjectID (rw)</span></a></li>
<li class='toclevel-5'><a href="Contributions%253ABCI2000Automation.html#string_SessionID_.28rw.29"><span class="tocnumber">4.1.1.7.2</span> <span class="toctext">string SessionID (rw)</span></a></li>
<li class='toclevel-5'><a href="Contributions%253ABCI2000Automation.html#string_DataDirectory_.28rw.29"><span class="tocnumber">4.1.1.7.3</span> <span class="toctext">string DataDirectory (rw)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class='toclevel-3'><a href="Contributions%253ABCI2000Automation.html#Connection_methods"><span class="tocnumber">4.1.2</span> <span class="toctext">Connection methods</span></a>
<ul>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_Connect.28.29"><span class="tocnumber">4.1.2.1</span> <span class="toctext">bool Connect()</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_Disconnect.28.29"><span class="tocnumber">4.1.2.2</span> <span class="toctext">bool Disconnect()</span></a></li>
</ul>
</li>
<li class='toclevel-3'><a href="Contributions%253ABCI2000Automation.html#Control_of_operation"><span class="tocnumber">4.1.3</span> <span class="toctext">Control of operation</span></a>
<ul>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_StartupModules.28_array.28string.29_modules_.29"><span class="tocnumber">4.1.3.1</span> <span class="toctext">bool StartupModules( array(string) modules )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_SetConfig.28.29"><span class="tocnumber">4.1.3.2</span> <span class="toctext">bool SetConfig()</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_Start.28.29"><span class="tocnumber">4.1.3.3</span> <span class="toctext">bool Start()</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_Stop.28.29"><span class="tocnumber">4.1.3.4</span> <span class="toctext">bool Stop()</span></a></li>
</ul>
</li>
<li class='toclevel-3'><a href="Contributions%253ABCI2000Automation.html#Parameters_and_system_state"><span class="tocnumber">4.1.4</span> <span class="toctext">Parameters and system state</span></a>
<ul>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_GetParameter.28_string_name.2C_string_byRef_value_.29"><span class="tocnumber">4.1.4.1</span> <span class="toctext">bool GetParameter( string name, string byRef value )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_SetParameter.28_string_name.2C_string_value_.29"><span class="tocnumber">4.1.4.2</span> <span class="toctext">bool SetParameter( string name, string value )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_LoadParametersLocal.28_string_file_.29"><span class="tocnumber">4.1.4.3</span> <span class="toctext">bool LoadParametersLocal( string file )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_LoadParametersRemote.28_string_file_.29"><span class="tocnumber">4.1.4.4</span> <span class="toctext">bool LoadParametersRemote( string file )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_AddStateVariable.28_string_name.2C_int_bitWidth.2C_double_initialValue_.29"><span class="tocnumber">4.1.4.5</span> <span class="toctext">bool AddStateVariable( string name, int bitWidth, double initialValue )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_SetStateVariable.28_string_name.2C_double_value_.29"><span class="tocnumber">4.1.4.6</span> <span class="toctext">bool SetStateVariable( string name, double value )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_GetControlSignal.28_int_channel.2C_int_element.2C_double_byRef_value_.29"><span class="tocnumber">4.1.4.7</span> <span class="toctext">bool GetControlSignal( int channel, int element, double byRef value )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_GetSystemState.28_string_byRef_state_.29"><span class="tocnumber">4.1.4.8</span> <span class="toctext">bool GetSystemState( string byRef state )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_GetStateVariable.28_string_name.2C_double_byRef_value_.29"><span class="tocnumber">4.1.4.9</span> <span class="toctext">bool GetStateVariable( string name, double byRef value )</span></a></li>
</ul>
</li>
<li class='toclevel-3'><a href="Contributions%253ABCI2000Automation.html#Scripting_methods"><span class="tocnumber">4.1.5</span> <span class="toctext">Scripting methods</span></a>
<ul>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#int_Execute.28_string_command_.29"><span class="tocnumber">4.1.5.1</span> <span class="toctext">int Execute( string command )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_SetScript.28_string_event.2C_string_commands_.29"><span class="tocnumber">4.1.5.2</span> <span class="toctext">bool SetScript( string event, string commands )</span></a></li>
<li class='toclevel-4'><a href="Contributions%253ABCI2000Automation.html#bool_GetScript.28_string_event.2C_string_byRef_script_.29"><span class="tocnumber">4.1.5.3</span> <span class="toctext">bool GetScript( string event, string byRef script )</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253ABCI2000Automation.html#Installation"><span class="tocnumber">5</span> <span class="toctext">Installation</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253ABCI2000Automation.html#Standard_installation"><span class="tocnumber">5.1</span> <span class="toctext">Standard installation</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ABCI2000Automation.html#Deinstallation"><span class="tocnumber">5.2</span> <span class="toctext">Deinstallation</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ABCI2000Automation.html#Installation_options"><span class="tocnumber">5.3</span> <span class="toctext">Installation options</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ABCI2000Automation.html#Troubleshooting"><span class="tocnumber">5.4</span> <span class="toctext">Troubleshooting</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253ABCI2000Automation.html#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253ABCI2000Automation.html#MATLAB"><span class="tocnumber">6.1</span> <span class="toctext">MATLAB</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ABCI2000Automation.html#Visual_Basic"><span class="tocnumber">6.2</span> <span class="toctext">Visual Basic</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253ABCI2000Automation.html#See_also"><span class="tocnumber">7</span> <span class="toctext">See also</span></a></li>
</ul>
</td></tr></table>
<a name="Synopsis"></a><h2>Synopsis</h2>
<p>BCI2000Automation is a Windows scripting interface to the BCI2000 Operator. It allows remote control of BCI2000 from any environment that provides access to Windows automation components. These environments comprise MATLAB, VisualBasic, C#, and others. It wraps up the functionality of the <a href="Programming_Reference%253ABCI2000Remote_Class.html" title="Programming Reference:BCI2000Remote Class">BCI2000Remote</a> C++ class. When writing C++ code, you should consider using that class directly rather than BCI2000Automation.
</p><p>Before you can use it, BCI2000Automation must be installed on your system. This is possible even if your user account has no administrative privileges. For details, see the <a href="Contributions%253ABCI2000Automation.html#Installation" title="">Installation</a> section below.
</p>
<a name="Location"></a><h2>Location</h2>
<p><a href="http://www.bci2000.org/svn/trunk/src/contrib/ExternalLinks/BCI2000Automation" class='external free' title="http://www.bci2000.org/svn/trunk/src/contrib/ExternalLinks/BCI2000Automation" rel="nofollow">http://www.bci2000.org/svn/trunk/src/contrib/ExternalLinks/BCI2000Automation</a>
</p>
<a name="Versioning"></a><h2>Versioning</h2>
<a name="Author"></a><h3>Author</h3>
<p>juergen.mellinger@uni-tuebingen.de
</p>
<a name="Source_Code_Revisions"></a><h3>Source Code Revisions</h3>
<ul><li>Initial development: 3918
</li><li>Tested under: 3942
</li></ul>
<a name="Functional_Description"></a><h2>Functional Description</h2>
<p>BCI2000Automation currently contains a single class called BCI2000Remote. This is an interface to the BCI2000 Operator module, and allows to start up, configure, and run BCI2000 from other applications.
</p><p>To use it, instantiate an object of type "BCI2000Automation.BCI2000Remote".
By default, calling the object's Connect() method will start up the Operator module residing in the same directory as BCI2000Automation. You may then use the StartupModules() method in order to start up BCI2000 core modules.
</p><p>Alternatively, you may specify the path to a BCI2000 batch file in the BCI2000/batch directory. An appropriate batch file should start up Operator and core modules, and needs to forward its command line arguments to the Operator module. All batch files coming with BCI2000 fulfil this condition. When a batch file is specified, there is no need to call the StartupModules() method.
</p><p>As yet another option, you may connect to an Operator module that is already running, e.g., on a remote machine on the network. In this case, set the BCI2000Remote object's OperatorPath property to an empty string, and its TelnetAddress property to the address that the remote Operator module is listening on, i.e. the remote machine's IP address, followed with a colon, and the port specified when starting up the remote Operator module. The remote Operator module must have been started with the --Telnet command line option, followed with the address to listen on. On the remote machine, this would typically be "localhost:3999". Don't use any of the ports between 4000 and 4002, as this will interfere with the communication between the Operator module, and BCI2000 core modules. Depending on whether the remote Operator module has been started up together with its core modules, or not, you may then call the StartupModules() method in order to start up BCI2000 core modules on the remote machine.
</p><p>Once all BCI2000 modules are running, you may load parameter files locally or remotely using the LoadParametersLocal() and LoadParametersRemote() methods. Subject ID, Session ID, and data directory are set using the respective BCI2000Remote properties.
</p><p>A recording may then be started by calling the Start() method. Depending on configuration, the recording will terminate automatically, or needs to be terminated by a call to the Stop() method.
</p><p>To run BCI2000 in a different configuration (i.e., with different core modules), it is not necessary to terminate the Operator module. Rather, you may execute StartupModules() multiple times in order to terminate currently running core modules, and start different ones.
</p><p>Once you are done using BCI2000, you may close the connection by calling the Disconnect() method, or by deleting the BCI2000Remote interface. Depending on whether the Operator module was started up by the previous Connect() call, this will terminate the Operator module as well. When connection was made to an already running Operator module, local or remote, the connection will be closed but the Operator module will remain running.
</p>
<a name="BCI2000Remote_Members"></a><h3>BCI2000Remote Members</h3>
<p>The BCI2000Remote class has the following members:
</p>
<a name="Properties"></a><h4>Properties</h4>
<a name="double_Timeout.3D5_.28rw.29"></a><h5>double Timeout=5 (rw)</h5>
<p>Timeout in seconds. Applies when establishing communication between BCI2000Remote and BCI2000.
</p>
<a name="string_OperatorPath.3D.3CBCI2000Automation_directory.3E.2FOperator.exe_.28rw.29"></a><h5>string OperatorPath=&lt;BCI2000Automation directory&gt;/Operator.exe (rw)</h5>
<p>Path to Operator module, or batch file. When empty, BCI2000Remote tries to connect to an already running Operator module which may be on a different machine. This property defaults to the Operator module located in the same directory as BCI2000Automation. You need to explicitly set it to an empty string if you want to connect to an Operator module which is already running.
</p>
<a name="string_TelnetAddress.3Dlocalhost:3999_.28rw.29"></a><h5>string TelnetAddress=localhost:3999 (rw)</h5>
<p>Telnet address to use for connection. Defaults to localhost:3999. When an operator path is specified, this must be a local address which will be used for communication. To connect to a remote machine, specify the machine's IP address, followed with BCI2000's listening port. You should take care to avoid specifying a port that is used by BCI2000's internal connections between Operator and core modules. By default, these are 4000, 4001, and 4002.
</p>
<a name="bool_WindowVisible.3Dtrue_.28rw.29"></a><h5>bool WindowVisible=true (rw)</h5>
<p>Visibility of the BCI2000 main window.
</p>
<a name="string_WindowTitle_.28rw.29"></a><h5>string WindowTitle (rw)</h5>
<p>The title of the BCI2000 main window.
</p>
<a name="string_Result_.28r.29"></a><h5>string Result (r)</h5>
<p>Text output of the previously executed command, or an error message when the previously executed command failed.
</p>
<a name="Recording_information"></a><h5>Recording information</h5>
<a name="string_SubjectID_.28rw.29"></a><h6>string SubjectID (rw)</h6>
<p>The subject ID for the next recording. When this property is empty, the subject ID is taken from the current value of the SubjectName parameter.
</p>
<a name="string_SessionID_.28rw.29"></a><h6>string SessionID (rw)</h6>
<p>The session ID for the next recording. When this property is empty, the session ID is taken from the SubjectSession parameter.
</p>
<a name="string_DataDirectory_.28rw.29"></a><h6>string DataDirectory (rw)</h6>
<p>The data directory for the next recording. When a relative path is given, it is taken relative to BCI2000/data. When this property is empty, the data directory is taken from the DataDirectory parameter.
</p>
<a name="Connection_methods"></a><h4>Connection methods</h4>
<a name="bool_Connect.28.29"></a><h5>bool Connect()</h5>
<p>Connect to BCI2000. When OperatorPath is not empty, this starts up the operator module before connecting. Will return true on success.
</p>
<a name="bool_Disconnect.28.29"></a><h5>bool Disconnect()</h5>
<p>Disconnect from an existing connection. Terminates the running operator module if it was started by the previous Connect() call.
</p>
<a name="Control_of_operation"></a><h4>Control of operation</h4>
<a name="bool_StartupModules.28_array.28string.29_modules_.29"></a><h5>bool StartupModules( array(string) modules )</h5>
<p>Start BCI2000 core modules, listed by executable name, including possible command line arguments. Each entry in the array corresponds to a single core module, given relative to the Operator module's working directory, which defaults to BCI2000/prog. You do not need to call this function if the OperatorPath property specifies a batch file rather than the Operator module itself.
</p>
<a name="bool_SetConfig.28.29"></a><h5>bool SetConfig()</h5>
<p>Applies the current set of parameters. Will be called from Start() automatically. Returns false if parameters could not be set, e.g. because the system was in running state, or because there was a preflight error when applying parameters. Use the Result property to obtain more error information.
</p>
<a name="bool_Start.28.29"></a><h5>bool Start()</h5>
<p>Starts a new run (recording) with current parameters. Returns false if the run could not be started. Use the Result property to obtain more error information.
</p>
<a name="bool_Stop.28.29"></a><h5>bool Stop()</h5>
<p>Stops the current run (recording).
</p>
<a name="Parameters_and_system_state"></a><h4>Parameters and system state</h4>
<a name="bool_GetParameter.28_string_name.2C_string_byRef_value_.29"></a><h5>bool GetParameter( string name, string byRef value )</h5>
<p>Copies the specified parameter's value into the "value" output argument. Returns false if parameter does not exist.
</p>
<a name="bool_SetParameter.28_string_name.2C_string_value_.29"></a><h5>bool SetParameter( string name, string value )</h5>
<p>Sets the specified parameter to the given value. The parameter must exist in the system. To add a parameter, use the Execute() method in conjunction with the INSERT PARAMETER scripting command.
</p>
<a name="bool_LoadParametersLocal.28_string_file_.29"></a><h5>bool LoadParametersLocal( string file )</h5>
<p>Load parameters from a file, relative to the working directory of the calling application. This function returns false if the specified file was not found but will not provide information whether parameters were sent successfully. Rather, illegal parameter lines will be silently ignored.
</p>
<a name="bool_LoadParametersRemote.28_string_file_.29"></a><h5>bool LoadParametersRemote( string file )</h5>
<p>Load parameters from a file, relative to the working directory of the Operator module connected to. Unless explicitly changed, that working directory is the BCI2000/prog directory in which the Operator module resides.
</p>
<a name="bool_AddStateVariable.28_string_name.2C_int_bitWidth.2C_double_initialValue_.29"></a><h5>bool AddStateVariable( string name, int bitWidth, double initialValue )</h5>
<p>Adds a state variable to the system. This is only possible before core modules have connected to the Operator module.	
</p>
<a name="bool_SetStateVariable.28_string_name.2C_double_value_.29"></a><h5>bool SetStateVariable( string name, double value )</h5>
<p>Sets the value of the named BCI2000 state variable to the given value. Returns false on error.
</p>
<a name="bool_GetControlSignal.28_int_channel.2C_int_element.2C_double_byRef_value_.29"></a><h5>bool GetControlSignal( int channel, int element, double byRef value )</h5>
<p>Copies the value of the control signal at the given indices into the "value" output variable. Indices are 1-based. Typically, the control signal has only a single element, and the number of output channels corresponds to the number of feedback dimensions in feedback experiments, or is 1 in evoked potential experiments.
</p>
<a name="bool_GetSystemState.28_string_byRef_state_.29"></a><h5>bool GetSystemState( string byRef state )</h5>
<p>Gets the current system state (i.e., state of operation). If no error occurred, the "state" output variable will contain the name of the current system state, which will be one of the names listed at <a href="User_Reference%253AOperator_Module_Scripting.html#GET_SYSTEM_STATE" title="User Reference:Operator Module Scripting">User Reference:Operator Module Scripting#GET_SYSTEM_STATE</a>.
</p>
<a name="bool_GetStateVariable.28_string_name.2C_double_byRef_value_.29"></a><h5>bool GetStateVariable( string name, double byRef value )</h5>
<p>Gets the value of a named BCI2000 state variable. If no error occurred, the value will be copied into the "value" output variable.
</p>
<a name="Scripting_methods"></a><h4>Scripting methods</h4>
<a name="int_Execute.28_string_command_.29"></a><h5>int Execute( string command )</h5>
<p>Execute a BCI2000 scripting command. If the command executed a shell command, returns the command's exit code, and 0 otherwise. This is different from other methods, whose boolean return value indicates success or failure. A documentation of BCI2000 Operator scripting commands may be found under <a href="User_Reference%253AOperator_Module_Scripting.html" title="User Reference:Operator Module Scripting">User Reference:Operator Module Scripting</a>.
</p>
<a name="bool_SetScript.28_string_event.2C_string_commands_.29"></a><h5>bool SetScript( string event, string commands )</h5>
<p>Associate a sequence of <a href="User_Reference%253AOperator_Module_Scripting.html" title="User Reference:Operator Module Scripting">Operator scripting commands</a> with an Operator module event. Operator module events are listed on the <a href="User_Reference%253AOperator_Module_Scripting.html#Handlers" title="User Reference:Operator Module Scripting">Operator scripting page</a>. To associate a script with multiple events, concatenate event names with pipe characters: <i>OnStart|OnResume</i>. Calling SetScript() will replace existing script associations. SetScript() will return false if any of the specified events do not exist.
</p>
<a name="bool_GetScript.28_string_event.2C_string_byRef_script_.29"></a><h5>bool GetScript( string event, string byRef script )</h5>
<p>Copies the script currently associated with the specified event into the script variable. Returns false if the specified event does not exist.
</p>
<a name="Installation"></a><h2>Installation</h2>
<a name="Standard_installation"></a><h3>Standard installation</h3>
<p>Before you can use BCI2000Automation, it must be made known to your Windows system. Each time when you are using BCI2000 on a different machine, or when you moved BCI2000 from its original installation location, you will need to manually install BCI2000Automation. This can be done by double-clicking the InstallAutomation.cmd batch file located in BCI2000/prog.
</p>
<a name="Deinstallation"></a><h3>Deinstallation</h3>
<p>BCI2000Automation installation adds a few registry keys to the current user's, or the machine's, "Software/Classes" key. When these keys remain on your machine after removing BCI2000, they will not do any harm, so you need not bother removing them. To remove those keys anyway, log in as the user for whom installation was performed, and execute
</p>
<pre>InstallAutomation /u
</pre>
<p>from a command prompt inside the BCI2000/prog directory.
</p>
<a name="Installation_options"></a><h3>Installation options</h3>
<p>BCI2000Automation may be installed or deinstalled for all users of a machine, or only for the user who runs the installation script. Selection between the two is done automatically, by determining whether the user has administrator rights. If so, installation is performed per-machine; if not, installation is done per-user. To manually choose the type of installation, you will need to execute the following command from the command prompt, inside the BCI2000/prog directory:
</p>
<pre>regsvr32 /n /i:&lt;option&gt; BCI2000Automation.dll
</pre>
<p>There, &lt;option&gt; may be one of the following:
</p>
<ul><li><i>user</i> to install for the current user only,
</li><li><i>system</i> to install for all users,
</li><li><i>any</i> to try installation for all users, and switch to per-user installation when that fails,
</li><li><i>both</i> to install both for all users, and the current user (this option only makes sense for deinstallation).
</li></ul>
<p>Note that per-user installation overrides system-wide installation. This may lead to confusing behavior of BCI2000Automation when switching between multiple users, and executing the installation program for those users, or when granting a certain user administrative privileges at one time, and later removing those privileges. To completely remove all references to BCI2000Automation from your machine under such circumstances, execute
</p>
<pre>rgsvr32 /n /u /s /i:both BCI2000Automation.dll
</pre>
<p>under all user accounts that may have executed the installation script, and make sure that at least one of those accounts has administrative privileges.
</p>
<a name="Troubleshooting"></a><h3>Troubleshooting</h3>
<p>If BCI2000Automation does not work as expected, execute BCI2000/prog/InstallAutomation under the user account that is going to run your automation client.
</p>
<a name="Examples"></a><h2>Examples</h2>
<a name="MATLAB"></a><h3>MATLAB</h3>
<pre>% Instantiate a BCI2000Remote object
bci = actxserver( 'BCI2000Automation.BCI2000Remote' );
try
  % Start the operator module, and connect to it
  ok = bci.Connect;
  if ~ok
    error( bci.Result )
  end 
  % Startup modules
  modules = { 'SignalGenerator --LogMouse=1', 'ARSignalProcessing', 'CursorTask' };
  ok = bci.StartupModules( modules );
  if ~ok
    error( bci.Result )
  end
  % Load a parameter file, and set subject information
  ok = bci.LoadParametersRemote( '../parms/examples/CursorTask_SignalGenerator.prm' );
  if ~ok
    error( bci.Result )
  end
  bci.SubjectID = 'SUB';
  % Start a run
  ok = bci.Start();
  if ~ok
    error( bci.Result )
  end

  % Display feedback signal
  state = 'Running';
  value = double( 0 );
  while( ok &amp;&amp; strcmp( state, 'Running' ) )
    % For formal reasons, the 'value' output variable must be specified both
    % for input and output.
    [~, value] = bci.GetControlSignal( 1, 1,  value );
    fprintf( 1, '%d\n', value );
    pause( 0.5 );
    % For formal reasons, the 'state' output variable must be specified both
    % for input and output.
    [ok, state] = bci.GetSystemState( state );
  end
catch exception
  % Make sure to delete the BCI2000Remote object
  bci.delete;
  throw(exception);
end
% Deleting the BCI2000Remote object will shut down the operator module when it was started by the object
bci.delete;
</pre>
<a name="Visual_Basic"></a><h3>Visual Basic</h3>
<p>Before running the following example, you need to add the BCI2000Automation object library to your VB project's references (Project-&gt;References).
</p>
<pre>' Instantiate a BCI2000Remote object
Dim bci As BCI2000Remote
Set bci = New BCI2000Remote
' Start the Operator module, and connect to it
ok = bci.Connect
If Not ok Then MsgBox bci.Result

' Startup modules
Dim modules(0 To 2) As String
modules(0) = "SignalGenerator --LogMouse=1"
modules(1) = "DummySignalProcessing"
modules(2) = "DummyApplication"
ok = bci.StartupModules(modules)
If Not ok Then MsgBox bci.Result

' Load a parameter file, and set subject information
ok = bci.LoadParametersRemote("../parms/examples/CursorTask_SignalGenerator.prm")
If Not ok Then MsgBox bci.Result
bci.SubjectID = "SUB"
 
' Start a run
ok = bci.Start

' Display the feedback signal while BCI2000 is running
Dim state As String
Dim value As Double
state = "Running"
value = 0
While ok And state = "Running"
  ok = bci.GetControlSignal(1, 1, value)
  Debug.Print value
  Threading.Thread.Sleep (500)
  Application.DoEvents
  ok = bci.GetSystemState(state)
Wend

' Shut down BCI2000
bci.Disconnect

' Release and delete the BCI2000Remote object
Set bci = Nothing
</pre>
<a name="See_also"></a><h2>See also</h2>
<p><a href="Programming_Reference%253ABCI2000Remote_Class.html" title="Programming Reference:BCI2000Remote Class">Programming Reference:BCI2000Remote Class</a>, <a href="Contributions%253ABCI2000PresentationLink.html" title="Contributions:BCI2000PresentationLink">Contributions:BCI2000PresentationLink</a>, <a href="Contributions%253ABCI2000Command.html" title="Contributions:BCI2000Command">Contributions:BCI2000Command</a>, <a href="Contributions%253ABCI2000PythonBindings.html" title="Contributions:BCI2000PythonBindings">Contributions:BCI2000PythonBindings</a>, <a href="Contributions%253AApplications.html" title="Contributions:Applications">Contributions:Applications</a>
</p>
<div class="printfooter">
</div>

</div><br style="clear:both" />

<div id='footer'><table border="0" cellspacing="0"><tr><td width='152' rowspan='1'>&nbsp;</td><td class='bottom' align='left' valign='top'></td></tr></table>
</div>
</div>

<div id='quickbar'>
<table class="image"><caption align="bottom"><h2>BCI2000 Help</h2></caption><tr><td><a href="BCI2000_Help.html"><img src='../../images/bci2000logo_small.png' height=100 width=100 alt='[BCI2000 Help]' /></a></td></tr></table>
<hr class='sep' /><a href="User_Tutorial%253ABCI2000_Tour.html">Getting Started</a><br />
<a href="User_Reference%253AContents.html">User Manual</a><br />
<a href="Technical_Reference%253AContents.html">Technical Reference</a><br />
<a href="Programming_Reference%253AContents.html">Programming Manual</a><br />
<a href="Contributions%253AContents.html">Contributions</a><br />
<ul><li><a href="Contributions%253AADCs.html">Data Acquisition</a></li>
<li><a href="Contributions%253AFileWriters.html">File Formats</a></li>
<li><a href="Contributions%253ASignalProcessing.html">Signal Processing</a></li>
<li><a href="Contributions%253AApplications.html">Applications</a></li>
<li><a href="Contributions%253ATools.html">Tools</a></li>
</ul><hr class='sep' />
<a href="BCI2000_Glossary.html">BCI2000 Glossary</a><br />
</div>

</body></html>