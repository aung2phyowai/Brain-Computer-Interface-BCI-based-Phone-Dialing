<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" >
<head>
<title>Contributions:NIDAQLogger - BCI2000 Help</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Contributions:NIDAQLogger,Contributions:NIDAQFilter" />
<link rel="shortcut icon" href="../../favicon.ico" />
<link rel='stylesheet' type='text/css' media='print' href='../skins/common/wikiprintable.css' />
<link rel="stylesheet" href="../skins/common/wikistandard.css@1" type="text/css" />
<link rel="stylesheet" href="../skins/common/common.css" type="text/css" />
<link rel="stylesheet" href="../skins/common/htmlhelp.css" type="text/css" />

<style type='text/css'>
a.new, #quickbar a.new { color: #CC2200; }
.editsection { display: none; }
#quickbar { position: absolute; top: 4px; left: 4px;  }
#article { margin-left: 152px; margin-right: 4px; }
</style>
</head>

<body bgcolor='#FFFFFF'>

<div id='content'>
<div id='topbar'>
<table border='0' cellspacing='0' width='98%'>
<tr>
</tr>
</table>
</div>

<div id='article'>
<h1 class="pagetitle">NIDAQLogger</h1><p class="subtitle">Contributions</p><hr class="sep" /><table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#Synopsis"><span class="tocnumber">1</span> <span class="toctext">Synopsis</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#Location"><span class="tocnumber">2</span> <span class="toctext">Location</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#Versioning"><span class="tocnumber">3</span> <span class="toctext">Versioning</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253ANIDAQLogger.html#Author"><span class="tocnumber">3.1</span> <span class="toctext">Author</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ANIDAQLogger.html#Version_History"><span class="tocnumber">3.2</span> <span class="toctext">Version History</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ANIDAQLogger.html#Source_Code_Revisions"><span class="tocnumber">3.3</span> <span class="toctext">Source Code Revisions</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#Testing"><span class="tocnumber">4</span> <span class="toctext">Testing</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#Known_Issues"><span class="tocnumber">5</span> <span class="toctext">Known Issues</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#Functional_Description"><span class="tocnumber">6</span> <span class="toctext">Functional Description</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#Adding_and_Compiling"><span class="tocnumber">7</span> <span class="toctext">Adding and Compiling</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#Parameters"><span class="tocnumber">8</span> <span class="toctext">Parameters</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253ANIDAQLogger.html#Command_Line_Parameters"><span class="tocnumber">8.1</span> <span class="toctext">Command Line Parameters</span></a>
<ul>
<li class='toclevel-3'><a href="Contributions%253ANIDAQLogger.html#Initializing_NIDAQLogger"><span class="tocnumber">8.1.1</span> <span class="toctext">Initializing NIDAQLogger</span></a></li>
<li class='toclevel-3'><a href="Contributions%253ANIDAQLogger.html#Device_Specification"><span class="tocnumber">8.1.2</span> <span class="toctext">Device Specification</span></a></li>
<li class='toclevel-3'><a href="Contributions%253ANIDAQLogger.html#Port_Specifications"><span class="tocnumber">8.1.3</span> <span class="toctext">Port Specifications</span></a></li>
<li class='toclevel-3'><a href="Contributions%253ANIDAQLogger.html#Example"><span class="tocnumber">8.1.4</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="Contributions%253ANIDAQLogger.html#BCI2000_Parameters"><span class="tocnumber">8.2</span> <span class="toctext">BCI2000 Parameters</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#States"><span class="tocnumber">9</span> <span class="toctext">States</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQLogger.html#Acquired_Data"><span class="tocnumber">10</span> <span class="toctext">Acquired Data</span></a></li>
</ul>
</td></tr></table>
<a name="Synopsis"></a><h2>Synopsis</h2>
<p>National Instruments Data Acquisition Module
</p>
<a name="Location"></a><h2>Location</h2>
<p>The file(s) should be in the following directory:
<a href="http://www.bci2000.org/svn/trunk/src/contrib/SignalSource/NIDAQ-MX/NIDAQ-Logging/" class='external free' title="http://www.bci2000.org/svn/trunk/src/contrib/SignalSource/NIDAQ-MX/NIDAQ-Logging/" rel="nofollow">http://www.bci2000.org/svn/trunk/src/contrib/SignalSource/NIDAQ-MX/NIDAQ-Logging/</a>
</p>
<a name="Versioning"></a><h2>Versioning</h2>
<a name="Author"></a><h3>Author</h3>
<p>Justin Renga (justin.renga@gmail.com)
</p>
<a name="Version_History"></a><h3>Version History</h3>
<a name="Source_Code_Revisions"></a><h3>Source Code Revisions</h3>
<ul><li>Initial development: --
</li><li>Tested under: --
</li><li>Known to compile under: --
</li><li>Broken since: --
</li></ul>
<a name="Testing"></a><h2>Testing</h2>
<p>The NIDAQLogger has been tested with the USB-6009 and PCI-6024E National Instruments boards at sampling rates up to and including 4096Hz, with sample block sizes up to and including 1024 samples/block. Both devices were running under DAQmx driver version 8.9.5 .
</p>
<a name="Known_Issues"></a><h2>Known Issues</h2>
<p>There are a couple of known issues with the NIDAQLogger that are listed below:
</p>
<ul><li>Occasional "glitching" may occur&nbsp;: the condition known as "glitching" is when some data gets swapped with slightly older data, producing a result that looks wrong.
</li><li>The NIDAQLogger, when coupled with the NIDAQmx Source Module, does not currently work at sampling rates above 8192Hz.
</li><li>Poor results may occur if the NIDAQLogger is used within 5 minutes of starting the BCI2000 computer up.
</li></ul>
<a name="Functional_Description"></a><h2>Functional Description</h2>
<p>Acquires signals using National Instruments Data Acquisition boards, other devices, and the computer. Device(s) must be connected to computer beforehand.
</p>
<a name="Adding_and_Compiling"></a><h2>Adding and Compiling</h2>
<p>To add and compile the NIDAQLogger module, make sure the latest NIDAQ MX drivers are installed on your computer.
When that is done, go into the C:\Program Files\National Instruments\NI-DAQ\DAQmx ANSI C Dev\ folder. Inside are two folders: lib and include. The lib folder will contain the NIDAQmx.lib file (inside of the folder msvc). Copy that into the project's library folder. Inside of the include folder is the NIDAQmx.h file, which contains the function prototypes needed to use the NIDAQLogger module. Move this file into the project's include folder. Make sure the project links the new .lib file, and that the NIDAQLogger.h and NIDAQLogger.cpp files include the NIDAQmx.h file correctly. The NIDAQLogger should now be able to compile normally.
</p>
<a name="Parameters"></a><h2>Parameters</h2>
<a name="Command_Line_Parameters"></a><h3>Command Line Parameters</h3>
<a name="Initializing_NIDAQLogger"></a><h4>Initializing NIDAQLogger</h4>
<p>To begin using the NIDAQLogger module, use the <code>--LogNIDAQin</code> flag, and set it equal to <b>1</b>.
To activate device(s) for specific functions, use the following flags:
</p>
<ul><li><code>--LogDigiIn</code> (for digital input)
</li><li><code>--LogAnaIn</code> (for analog input)
</li></ul>
<p>The format for the inputs for the above flags is as follows: <code>[flag]="[device name]-[port specification]"</code>
Note that if <code>--LogNIDAQ</code> is used, that at least one of the two above flags MUST be used.
</p>
<a name="Device_Specification"></a><h4>Device Specification</h4>
<p>The device name (usually) is to be written as "Dev1" or "Dev2" (without the ""). Afterwards, use a - to indicate the device name is finished. If the device number is unclear, run the program with the <code>--LogNIDAQin</code> flag activated, and look at the Operator Log. The devices (along with their number) will be listed.
</p>
<a name="Port_Specifications"></a><h4>Port Specifications</h4>
<p>There are two acceptable states that the user can specify for each port:
</p>
<ul><li><b>0</b> - this indicates the port is <b>INACTIVE</b>.
</li><li><b>1</b> - this indicates the port is <b>ACTIVE</b>
</li></ul>
<p><i>Important: If both the NIDAQLogger and the NIDAQFilter (see <a href="Contributions%253ANIDAQFilter.html" title="Contributions:NIDAQFilter">Contributions:NIDAQFilter</a>) are being used, and both are using the digital lines on the same device, make sure that any port that is being referenced in a parameter is referenced only once. One port cannot use both digital input and digital output functionality, and will cause BCI2000 to throw an error, saying that the line is RESERVED. </i>
</p>
<a name="Example"></a><h4>Example</h4>
<p>Let's assume that the user wants to use one device for both analog and digital input. The device has 8 Analog Input ports and 12 Digital I/O ports.
The user also wants to use the 3rd and 4th analog input ports, and the 4th and 10th digital ports for digital input.
</p><p>The user needs to use 3 flags to accomplish this:
</p>
<ul><li><code>--LogNIDAQin=1</code> -&gt; This flag activates the NIDAQLogger for use.
</li><li><code>--LogDigiIn="Dev1-000100000100"</code> -&gt; This flag indicates that the user wants to use digital I/O. "Dev1" is the name of the device connected to the computer that she wants to use. <code>0001000000100</code> indicates that the user wants ports 4 and 10 (the <b>1</b>'s) as <b>ACTIVE</b>.
</li><li><code>--LogAnaIn="Dev1-00011000"</code> -&gt; This flag indicates that she wants to use analog output. "Dev1" is the name of the device connected to the computer that she wants to use. <code>00011000</code> indicates that she wants to the use ports 3 and 4 on analog input.
</li></ul>
<p>The full command (assuming she uses this with SignalGenerator.exe) that the user would use is the following:
</p><p><code>SignalGenerator.exe --LogNIDAQin=1 --LogDigiIn="Dev1-000100000100" --LogAnaIn="Dev1-00011000"</code>
</p>
<a name="BCI2000_Parameters"></a><h3>BCI2000 Parameters</h3>
<p>There are two possible parameters that the user will be able to use. They are outlined below:
</p>
<ul><li><b>#IVRanges</b> - the available voltage ranges for analog input for the given device (where <b>#</b> will be replaced by the device name)
<ul><li><i>This parameter will only be enabled if the </i><code>--LogAnaIn</code><i> flag is being used</i>.
</li></ul>
</li><li><b>#InSampleRate</b> - the sampling rate for the NIDAQLogger
<ul><li><i>This parameter will be here if the </i><code>--LogNIDAQ</code><i> flag is being used</i>.
</li></ul>
</li></ul>
<p>The parameters will be located under the <b>Source</b> tab, in the section labeled <i>NILogger</i>.
</p>
<a name="States"></a><h2>States</h2>
<p>The states that are available are dependent on the port specifications declared in the command line parameters. The format for the states is the following:
</p><p><b>NIDev#[A:D]INPUT#</b>
</p>
<ul><li>The first <b>#</b> refers to the device number.
</li><li>The second <b>#</b> refers to the line number (starting at <b>0</b>).
</li><li>The <b>[A:D]</b> denotes if the state refers to an analog (<b>A</b>) or a digital (<b>D</b>) channel.
</li></ul>
<p>For example, if the command parameters look like this:
</p><p><code>SignalGenerator.exe --LogNIDAQin=1 --LogDigiIn="Dev1-000100000100" --LogAnaIn="Dev1-10011000"</code>
</p><p>the states that will be created are the following:
</p><p><code>
</p>
<pre>     NIDev1DINPUT3     NIDev1DINPUT9     NIDev1AINPUT0
             NIDev1AINPUT2     NIDev1AINPUT3
</pre>
<p></code>
</p>
<a name="Acquired_Data"></a><h2>Acquired Data</h2>
<p>The data (analog) that is acquired by the device is translated to make sure that all of the data will fit inside of the state's parameters. Due to this fact, the data needs to be translated back in order to return it to units of milliVolts (mV). This can be done by subtracting the data by (2000*upper voltage bound). For example, if the data was logged with the range -10V to 10V, then the data must be subtracted by 20,000.
</p>
<div class="printfooter">
</div>

</div><br style="clear:both" />

<div id='footer'><table border="0" cellspacing="0"><tr><td width='152' rowspan='1'>&nbsp;</td><td class='bottom' align='left' valign='top'></td></tr></table>
</div>
</div>

<div id='quickbar'>
<table class="image"><caption align="bottom"><h2>BCI2000 Help</h2></caption><tr><td><a href="BCI2000_Help.html"><img src='../../images/bci2000logo_small.png' height=100 width=100 alt='[BCI2000 Help]' /></a></td></tr></table>
<hr class='sep' /><a href="User_Tutorial%253ABCI2000_Tour.html">Getting Started</a><br />
<a href="User_Reference%253AContents.html">User Manual</a><br />
<a href="Technical_Reference%253AContents.html">Technical Reference</a><br />
<a href="Programming_Reference%253AContents.html">Programming Manual</a><br />
<a href="Contributions%253AContents.html">Contributions</a><br />
<ul><li><a href="Contributions%253AADCs.html">Data Acquisition</a></li>
<li><a href="Contributions%253AFileWriters.html">File Formats</a></li>
<li><a href="Contributions%253ASignalProcessing.html">Signal Processing</a></li>
<li><a href="Contributions%253AApplications.html">Applications</a></li>
<li><a href="Contributions%253ATools.html">Tools</a></li>
</ul><hr class='sep' />
<a href="BCI2000_Glossary.html">BCI2000 Glossary</a><br />
</div>

</body></html>