<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" >
<head>
<title>Contributions:NIDAQFilter - BCI2000 Help</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Contributions:NIDAQFilter,Contributions:NIDAQLogger" />
<link rel="shortcut icon" href="../../favicon.ico" />
<link rel='stylesheet' type='text/css' media='print' href='../skins/common/wikiprintable.css' />
<link rel="stylesheet" href="../skins/common/wikistandard.css@1" type="text/css" />
<link rel="stylesheet" href="../skins/common/common.css" type="text/css" />
<link rel="stylesheet" href="../skins/common/htmlhelp.css" type="text/css" />

<style type='text/css'>
a.new, #quickbar a.new { color: #CC2200; }
.editsection { display: none; }
#quickbar { position: absolute; top: 4px; left: 4px;  }
#article { margin-left: 152px; margin-right: 4px; }
</style>
</head>

<body bgcolor='#FFFFFF'>

<div id='content'>
<div id='topbar'>
<table border='0' cellspacing='0' width='98%'>
<tr>
</tr>
</table>
</div>

<div id='article'>
<h1 class="pagetitle">NIDAQFilter</h1><p class="subtitle">Contributions</p><hr class="sep" /><table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class='toclevel-1'><a href="Contributions%253ANIDAQFilter.html#Synopsis"><span class="tocnumber">1</span> <span class="toctext">Synopsis</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQFilter.html#Location"><span class="tocnumber">2</span> <span class="toctext">Location</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQFilter.html#Versioning"><span class="tocnumber">3</span> <span class="toctext">Versioning</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253ANIDAQFilter.html#Author"><span class="tocnumber">3.1</span> <span class="toctext">Author</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ANIDAQFilter.html#Version_History"><span class="tocnumber">3.2</span> <span class="toctext">Version History</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ANIDAQFilter.html#Source_Code_Revision"><span class="tocnumber">3.3</span> <span class="toctext">Source Code Revision</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQFilter.html#Functional_Description"><span class="tocnumber">4</span> <span class="toctext">Functional Description</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQFilter.html#Adding_and_Compiling"><span class="tocnumber">5</span> <span class="toctext">Adding and Compiling</span></a></li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQFilter.html#Parameters"><span class="tocnumber">6</span> <span class="toctext">Parameters</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253ANIDAQFilter.html#Command_Line_Parameters"><span class="tocnumber">6.1</span> <span class="toctext">Command Line Parameters</span></a>
<ul>
<li class='toclevel-3'><a href="Contributions%253ANIDAQFilter.html#Initializing_the_NIDAQFilter"><span class="tocnumber">6.1.1</span> <span class="toctext">Initializing the NIDAQFilter</span></a></li>
<li class='toclevel-3'><a href="Contributions%253ANIDAQFilter.html#Device_Specification"><span class="tocnumber">6.1.2</span> <span class="toctext">Device Specification</span></a></li>
<li class='toclevel-3'><a href="Contributions%253ANIDAQFilter.html#Port_Specifications"><span class="tocnumber">6.1.3</span> <span class="toctext">Port Specifications</span></a></li>
<li class='toclevel-3'><a href="Contributions%253ANIDAQFilter.html#A_Completed_Flag"><span class="tocnumber">6.1.4</span> <span class="toctext">A Completed Flag</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="Contributions%253ANIDAQFilter.html#BCI2000_Parameters"><span class="tocnumber">6.2</span> <span class="toctext">BCI2000 Parameters</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Contributions%253ANIDAQFilter.html#States"><span class="tocnumber">7</span> <span class="toctext">States</span></a>
<ul>
<li class='toclevel-2'><a href="Contributions%253ANIDAQFilter.html#Template"><span class="tocnumber">7.1</span> <span class="toctext">Template</span></a></li>
<li class='toclevel-2'><a href="Contributions%253ANIDAQFilter.html#Example"><span class="tocnumber">7.2</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<a name="Synopsis"></a><h2>Synopsis</h2>
<p>A filter that outputs different states from BCI2000 to outputs connected to a National Instruments Board running DAQmx 8.5 or higher.
</p>
<a name="Location"></a><h2>Location</h2>
<p>The file(s) should be in the following directory:
<a href="http://www.bci2000.org/svn/trunk/src/contrib/SignalSource/NIDAQ-MX/NIDAQ-Logging/" class='external free' title="http://www.bci2000.org/svn/trunk/src/contrib/SignalSource/NIDAQ-MX/NIDAQ-Logging/" rel="nofollow">http://www.bci2000.org/svn/trunk/src/contrib/SignalSource/NIDAQ-MX/NIDAQ-Logging/</a>
</p>
<a name="Versioning"></a><h2>Versioning</h2>
<a name="Author"></a><h3>Author</h3>
<p>Justin Renga (justin.renga@gmail.com)
</p>
<a name="Version_History"></a><h3>Version History</h3>
<p>1.0
</p>
<a name="Source_Code_Revision"></a><h3>Source Code Revision</h3>
<p>Not Applicable
</p>
<a name="Functional_Description"></a><h2>Functional Description</h2>
<p>The NIDAQFilter uses any DAQmx 8.5 or higher compliant board and allows the user to pipe state data from BCI2000 through the board. All necesary components must be connected to the BCI computer before initiating a module using the filter.
</p>
<a name="Adding_and_Compiling"></a><h2>Adding and Compiling</h2>
<p>To add and compile the NIDAQFilter module, make sure the latest NIDAQ MX drivers are installed on your computer. When that is done, go into the C:\Program Files\National Instruments\NI-DAQ\DAQmx ANSI C Dev\ folder. Inside are two folders: lib and include. The lib folder will contain the NIDAQmx.lib file (inside of the folder msvc). Copy that into the project's library folder. Inside of the include folder is the NIDAQmx.h file, which contains the function prototypes needed to use the NIDAQLogger module. Move this file into the project's include folder. Make sure the project links the new .lib file, and that the NIDAQFilter.h and NIDAQFilter.cpp files include the NIDAQmx.h file correctly. The NIDAQFilter should now be able to compile normally.
</p>
<a name="Parameters"></a><h2>Parameters</h2>
<p>The NIDAQFilter uses command line parameters to initialize the device(s) and set up the active ports. It then uses BCI2000 parameters for finer controls over the device, such as changing the sampling rate of the device.
</p>
<a name="Command_Line_Parameters"></a><h3>Command Line Parameters</h3>
<a name="Initializing_the_NIDAQFilter"></a><h4>Initializing the NIDAQFilter</h4>
<p>To begin using the NIDAQFilter, use the <code>--LogNIDAQout</code> flag and set it equal to <b>1</b>. To activate device(s) for specific functions, use the following flags:
</p>
<ul><li><code>--LogDigiOut</code> --&gt; Enable the device to use digital output characteristics
</li><li><code>--LogAnaOut</code> --&gt; Enable the device to use analog output characteristics
</li></ul>
<p>The format for the outputs for above flags is as follows:
</p>
<div class="center"><code>[flag]="[device specification]-[port specifications]"</code></div>
<p>Please note that if <code>--LogNIDAQout</code> is enabled, then at least one of the above flags <b>MUST</b> be used.
</p>
<a name="Device_Specification"></a><h4>Device Specification</h4>
<p>The device name is to be written as "Dev1" or "Dev2" (without the quotes) in the first part of the parameter value. After the device name is specified, use a hyphen (-) to indicate the device name is finished. For example, the first part of the parameter value would look like this: <code> "Dev1-</code>.
</p><p><i>If the device numbers are unclear, run the filter with just the <code>--LogNIDAQout</code> flag specified. The device names (along with their familiar names) will appear in the operator log.</i>
</p>
<a name="Port_Specifications"></a><h4>Port Specifications</h4>
<p>There are two acceptable states that the user can specify for each port that they are going to use:
</p>
<ul><li><b>0</b> --&gt; the associated port WILL NOT be used
</li><li><b>1</b> --&gt; the associated port WILL be used
</li></ul>
<p>The values will be used for every single port that the user wants to use. For example, if the user wants to use ports 3 and 5 on a device with 10 ports, then the port specification for that device will be the following:
</p>
<div class="center"><code>0010100000</code></div>
<p>Notice how even though the user wants to use only 2 ports, all 10 ports have been indicated. This is required. Any port that is not needed should be marked with a <b>0</b>. If the number of ports specified in the parameter file does not match the number of ports found on the device, an error will be thrown, showing the number of ports were specified and how many ports there are for that device function.
</p><p><i>Important: If both the NIDAQLogger(<a href="Contributions%253ANIDAQLogger.html" title="Contributions:NIDAQLogger">Contributions:NIDAQLogger</a>) and the NIDAQFilter are being used, and both are using the digital lines on the same device, make sure that any port that is being referenced in a parameter is referenced only once. One port cannot use both digital input and digital output functionality, and will cause BCI2000 to throw an error, saying that the line is RESERVED.</i>
</p>
<a name="A_Completed_Flag"></a><h4>A Completed Flag</h4>
<p>The following is the completed flag, whose parts were described above:
</p>
<div class="center"><code>--LogAnaOut="Dev1-0010100000"</code></div>
<p>The above flag tells the filter that the user wants to use the analog output ports on Device 1, which has 10 ports on it. The user wants to use the 3rd and 5th ports on the device, but leave everything else unused.
</p>
<a name="BCI2000_Parameters"></a><h3>BCI2000 Parameters</h3>
<p>After the commandline parameters have been set, more parameters may be configured in the Configuration dialog box in BCI2000. Under the header <i>NIDAQFilter</i>, the following parameters MAY appear, as some of them are dependant on flags being used:
</p>
<ul><li><b>#OVRanges</b> [ENUMERATION] --&gt; This parameter tells the user if there are multiple output voltage ranges that are acceptable for use. If not, then the parameter will NOT show up. The parameter is activated by the <code>--LogAnaOut</code> flag.
</li><li><b>FilterExpressions</b> [MATRIX] --&gt; This parameter allows the user to associate different states to individual output lines on the board. By clicking on the Edit Matrix button, the user will see a list of the lines that are active on the board, and a space to put an expression. This parameter will always show up, regardless of the flags being used.
</li></ul>
<a name="States"></a><h2>States</h2>
<a name="Template"></a><h3>Template</h3>
<p>The states are constructed in a contextual manner, that is to say, they are created based on the channels that the user decides to use. The template of the state names is shown below:
</p>
<div class="center"><code><b>NI[device name][A:D]OUTPUT[port number-1]</b></code></div>
<p>Some key things about the template:
</p>
<ul><li>[device name] -&gt; the name of the device to which the port is associated to (for example, if Device 4 is being used, then there will be a state that begins with NIDev4 will exist)
</li><li>[A:D] -&gt; analog or digital state (an analog state has a bit width of 16, while a digital state has a bit width of 1). This is dependant on the way the device is being used, and is not settable by the user.
</li><li>[port number - 1] -&gt; the number of the port being used (the states begin at port 0, so when port 4 is being used, the number in the state will be 3)
</li></ul>
<a name="Example"></a><h3>Example</h3>
<p>If the following parameter list were used as a user's command line parameter:
</p>
<div class="center"><code>--LogNIDAQout=1 --LogAnaOut="Dev1-00100010100" --LogDigiOut="Dev2-00100001010"</code></div>
<p>Then the following states would be produced:
<center><code>
</p>
<pre>     NIDev1AOUTPUT2     NIDev1AOUTPUT6     NIDev1AOUTPUT8
     NIDev2DOUTPUT2     NIDev2DOUTPUT7     NIDev2DOUTPUT9
</pre>
<p></code></center>
</p>
<div class="printfooter">
</div>

</div><br style="clear:both" />

<div id='footer'><table border="0" cellspacing="0"><tr><td width='152' rowspan='1'>&nbsp;</td><td class='bottom' align='left' valign='top'></td></tr></table>
</div>
</div>

<div id='quickbar'>
<table class="image"><caption align="bottom"><h2>BCI2000 Help</h2></caption><tr><td><a href="BCI2000_Help.html"><img src='../../images/bci2000logo_small.png' height=100 width=100 alt='[BCI2000 Help]' /></a></td></tr></table>
<hr class='sep' /><a href="User_Tutorial%253ABCI2000_Tour.html">Getting Started</a><br />
<a href="User_Reference%253AContents.html">User Manual</a><br />
<a href="Technical_Reference%253AContents.html">Technical Reference</a><br />
<a href="Programming_Reference%253AContents.html">Programming Manual</a><br />
<a href="Contributions%253AContents.html">Contributions</a><br />
<ul><li><a href="Contributions%253AADCs.html">Data Acquisition</a></li>
<li><a href="Contributions%253AFileWriters.html">File Formats</a></li>
<li><a href="Contributions%253ASignalProcessing.html">Signal Processing</a></li>
<li><a href="Contributions%253AApplications.html">Applications</a></li>
<li><a href="Contributions%253ATools.html">Tools</a></li>
</ul><hr class='sep' />
<a href="BCI2000_Glossary.html">BCI2000 Glossary</a><br />
</div>

</body></html>